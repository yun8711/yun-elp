---
title: 规范
---

<h1>kd-elp 规范说明</h1>

### 写在前面

众所周知，在kd-components组件库的开发中，由于当时的业务需求急迫，组件库急于上线，所以在开发过程中，有很多不规范和不完善的地方，
比：如组件的命名、样式的处理、项目的目录结构、组件的文档编写、组件单元测试等等，这些都是需要改进的地方。

规范本身没有好坏之分，只有适合和不适合，规范的目的是为了提高代码的可读性、可维护性、可扩展性、可测试性、可靠性、健壮性等等，所以在开发过程中，需要尽量遵守。

本着宁缺勿滥的原则，kd-elp组件库项目中使用了较多的代码规范校验，并且会开启较为严格的代码审核，如果你的代码不符合规范，或者不够优雅，或者不够简洁，或者不够高效，或者不够可维护，或者不
够健壮。那么你的代码将会被驳回，这是为了保证组件的质量和项目的可维护性。

如果对具体的规则有疑问，可以在群里提出来，大家一起讨论，如果有更好的建议，也可以提出来，大家一起完善。

### 常规代码规范

eslint：vue官方推荐的代码规范检查<br>
prettier：代码格式化<br>
stylelint：样式规范检查<br>

在kd-elp中，利用git hook 在提交代码时自动执行eslint、prettier、stylelint等代码规范检查，如果不符合规范，将会被驳回。

### css命名规范

遵循 BEM 命名规范

BEM (Block, Element, Modifier) 是一种用于编写 CSS 的命名规范。这种规范旨在通过提供一种明确的 CSS 类名命名方式，使得 CSS 代码更易于阅读和理解，也更易于维护。<br>

Block（块）：代表了一个独立的实体，它是意义上的独立体，例如，header、container、menu、checkbox、input等。<br>
Element（元素）：代表了 Block 内部的一个组成部分，它在语义上与 Block 紧密关联。例如，menu item、list item、checkbox caption等，都可以是元素。<br>
Modifier（修饰符）：代表了 Block 或 Element 的一种状态或者是一种行为。例如，disabled、highlighted、checked、fixed、size big等。<br>

在 BEM 中，类名的命名通常是这样的：<br>
Block：.block<br>
Element：.block**element<br>
Modifier：.block--modifier 或 .block**element--modifier<br>

> kd-elp组件库中，对Modifier部分做了微调，使用一个-连接符来连接Modifier，目的是为了与element-plus组件库保持相似的风格

例如：在 k-page-head组件中，最外层的div的类名为 k-page-head，内部的元素中，k-page-head**label 表示标题文本，k-page-head**sub 表示副标题，k-page-head\_\_extra 表示右侧扩展内容。<br>

除此之外，还有一些全局性的类名，如：is-border、is-ellipsis，这些类名可以用于修饰任何组件，但是通常不会单独使用，而是与BEM规范的类名一起使用，例如：k-page-head\_\_label.is-ellipsis。

这样的命名方法，既能够**清晰的表达出组件的结构，又能够避免样式的冲突**。

### 提交规范

代码提交规范的意义主要体现在以下几个方面：

- 提高代码可读性：规范的提交信息可以清晰地描述每次提交的目的和改动内容，使得其他开发者能够更快地理解代码的变化。
- 方便代码审查：在进行代码审查时，规范的提交信息可以帮助审查者快速了解代码的改动，提高审查效率。
- 便于版本控制：规范的提交信息可以帮助开发者快速定位和理解历史版本的改动，便于版本回滚和问题排查。
- 自动化工具友好：规范的提交信息可以被自动化工具（如自动化构建、自动化测试、自动化部署等）解析和使用，提高自动化工具的效率和准确性。

在kd-elp组件库中，遵循标准 Angular commit 规范，并使用了commitlint、cz-git、lint-staged、husky等工具来规定和检查提交信息。<br>

在提交代码时，执行`pnpm commit`命令，会弹出一个交互式的命令行界面，根据提示选择和输入相应的信息即可。

### 测试规范

前端测试工作是很容易被忽略的一个环节，但又是组件开发中保证组件质量的重要内容。所以在kd-elp中，引入了单元测试，来保证组件基本功能的正确性。

在kd-elp中，使用了vitest和@vue/test-utils来编写单元测试，测试用例文件统一放在组件目录目录下的`__test__`目录中。
通过`pnpm new`创建一个新的组件时，会自动创建一个测试用例文件，你只需要在这个文件中编写测试用例即可。

在编写组件的单元测试时，需要遵循以下规范：

- 每个组件都应该有对应的单元测试：无论组件的复杂度如何，都应该为其编写单元测试。这可以确保组件的基本功能正常工作，并且在后续的开发过程中，如果对组件进行修改，我们可以通过单元测试快速检查是否引入了新的错误
- 测试覆盖率：我们应该尽可能地提高测试覆盖率。这意味着我们的测试应该覆盖到组件的所有重要功能。例如，如果组件有一些条件渲染的逻辑，我们应该编写测试来检查这些逻辑。

注意：单元测试只是前端测试中的一部分，且是在组件库开发中最合适的测试项目，但也只能保证基本功能正常，所以在编写单元测试时，应该尽可能的覆盖组件的所有重要功能，但是也不要过度测试，否则会增加开发成本。

### 文档规范

好的文档可以让使用者更快的了解组件的使用场景和使用方法。

通过`pnpm new`创建一个新的组件时，会自动创建该组件的文档文件，它位于`kd-elp/docs/docs/components` 目录下：

- index.md：组件的使用文档，在这里编写组件的使用方法，使用示例，组件的属性、方法、事件等等
- examples/：该目录下存放组件的示例代码，vitepress会自动将该目录下的代码注入到最终生成的文档页面中，方便使用者查看组件示例的源码。

注意：必须完整而准确的编写文档中的 属性、方法、事件，组件库会依据这些信息生成webstrom、vscode等编辑器的智能提示文件。
